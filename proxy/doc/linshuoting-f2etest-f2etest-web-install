{"id":1486763,"slug":"f2etest-web-install","title":"F2etest-web 部署","book_id":245753,"book":{"id":245753,"type":"Book","slug":"f2etest","name":"F2etest","user_id":296279,"description":"F2etest 是一个面向前端、测试、产品等岗位的多浏览器兼容性测试整体解决方案。","creator_id":94302,"public":1,"items_count":12,"likes_count":0,"watches_count":2,"content_updated_at":"2019-04-23T05:44:30.303Z","updated_at":"2019-04-23T06:32:14.000Z","created_at":"2019-03-21T03:15:48.000Z","namespace":"linshuoting/f2etest","user":{"id":94302,"type":"User","login":"linshuoting","name":"说听(Stngle)","description":"F&D艺术家   \nhttps://github.com/Stngle","avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150368242-avatar/4fa5a6cc-1636-43cd-b085-fce8ad30be09.png","large_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150368242-avatar/4fa5a6cc-1636-43cd-b085-fce8ad30be09.png?x-oss-process=image/resize,m_fill,w_320,h_320","medium_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150368242-avatar/4fa5a6cc-1636-43cd-b085-fce8ad30be09.png?x-oss-process=image/resize,m_fill,w_160,h_160","small_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150368242-avatar/4fa5a6cc-1636-43cd-b085-fce8ad30be09.png?x-oss-process=image/resize,m_fill,w_80,h_80","books_count":1,"public_books_count":0,"followers_count":3,"following_count":2,"created_at":"2018-03-21T12:59:06.000Z","updated_at":"2019-04-23T05:43:09.000Z","_serializer":"v2.user"},"_serializer":"v2.book"},"user_id":182712,"creator":{"id":182712,"type":"User","login":"undead25","name":"双龙","description":null,"avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/182712/1554346835965-avatar/a9f57da4-3a12-43bc-be2c-85b7e215b7c7.png","large_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/182712/1554346835965-avatar/a9f57da4-3a12-43bc-be2c-85b7e215b7c7.png?x-oss-process=image/resize,m_fill,w_320,h_320","medium_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/182712/1554346835965-avatar/a9f57da4-3a12-43bc-be2c-85b7e215b7c7.png?x-oss-process=image/resize,m_fill,w_160,h_160","small_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/182712/1554346835965-avatar/a9f57da4-3a12-43bc-be2c-85b7e215b7c7.png?x-oss-process=image/resize,m_fill,w_80,h_80","books_count":0,"public_books_count":0,"followers_count":0,"following_count":1,"created_at":"2018-09-26T16:45:26.000Z","updated_at":"2019-04-04T03:00:41.000Z","_serializer":"v2.user"},"format":"lake","body":"","body_draft":"","body_html":"<h2 id=\"858e7e78\">一、前言</h2><p><br /></p><p>本部署教程旨在搭建 F2etest 最小体验版，请预先准备 CentOS 7 虚拟机或物理机 1 台。</p><p><br /></p><h2 id=\"9cbd9b0f\">二、部署</h2><p><br /></p><blockquote><p>请预先在 CentOS 机器上安装最新版的 <code>Docker</code>，如已安装请忽略，安装教程：<a href=\"https://www.yuque.com/grasilife/docker/install-centos\" target=\"_blank\">https://www.yuque.com/grasilife/docker/install-centos</a>，</p></blockquote><p><br /></p><pre data-lang=\"bash\"><code># 获取 `f2etest-web` 镜像\ndocker pull registry.cn-hangzhou.aliyuncs.com/f2etest/f2etest-web\n\n# 启动容器\n# 映射本地端口，这里已 80 为例，请确保此端口未被占用\n# 如果 80 被占用，请修改为其它可用端口，例如 8080 端口：-p 8080:80\ndocker run -dit --privileged -p 80:80 --name f2etest registry.cn-hangzhou.aliyuncs.com/f2etest/f2etest-web\n\n# 进入容器\ndocker exec -it f2etest bash\n\n# 初始化数据库表并启动 Web\nsource setup.sh</code></pre><p><br /></p><h2 id=\"7bc1a177\">三、配置</h2><p><br /></p><blockquote><p>主要配置 Windows Server IP 地址，其他相关配置已预设。</p></blockquote><p><br /></p><p>先进入容器，已进入请忽略。（<code>docker exec -it f2etest bash</code>）</p><p><br /></p><h3 id=\"5ab70705\">3.1 站点配置</h3><p><br /></p><pre data-lang=\"bash\"><code>vi /home/f2etest-web/conf/site.json</code></pre><p><br /></p><p>修改 <code>guacamoleApi</code> 字段，IP 地址改为 CentOS 机器 IP 地址，端口号改为运行容器时映射的本地端口号，<strong>80</strong> 端口可忽略。</p><p><br /></p><p>假设 CentOS IP 地址为 <strong>10.1.1.1</strong>，容器映射的端口号为 <strong>8080</strong>：</p><p><br /></p><pre data-lang=\"json\"><code>&quot;guacamoleApi&quot;: &quot;http://10.1.1.1:8080/guacamole/client.xhtml&quot;,</code></pre><p><br /></p><p>了解更多：<a href=\"https://www.yuque.com/artist/f2etest/f2etest-web#1534b4e9\" target=\"_blank\">https://www.yuque.com/artist/f2etest/f2etest-web#1534b4e9</a></p><p><br /></p><h3 id=\"949f1586\">3.2 服务器配置</h3><p><br /></p><pre data-lang=\"bash\"><code>vi /home/f2etest-web/conf/server.json</code></pre><p><br /></p><p>修改数组中第一条记录的 <code>ip</code> 为 Windows Server 的 IP 地址。</p><p><br /></p><pre data-lang=\"bash\"><code># 重启 web\npm2 restart 0</code></pre><p><br /></p><p>了解更多：<a href=\"https://www.yuque.com/artist/f2etest/f2etest-web#58c92670\" target=\"_blank\">https://www.yuque.com/artist/f2etest/f2etest-web#58c92670</a></p><p><br /></p><h3 id=\"1434e7e4\">3.3 免登配置</h3><p><br /></p><pre data-lang=\"bash\"><code>vi /etc/guacamole/noauth-config.xml</code></pre><p><br /></p><p>修改 <code>&lt;param name=&quot;hostname&quot; value=&quot;192.168.1.102&quot; /&gt;</code> 中的 <code>value</code> 为 Windows Server 的 IP 地址。</p><p><br /></p><pre data-lang=\"bash\"><code># 重启 tomcat8\nservice tomcat8 restart</code></pre><p><br /></p><p>了解更多：<a href=\"https://www.yuque.com/artist/f2etest/f2etest-web#c1a9669b\" target=\"_blank\">https://www.yuque.com/artist/f2etest/f2etest-web#c1a9669b</a></p><p><br /></p><h2 id=\"03225136\">4. 相关服务</h2><p><br /></p><ul><li><code>nginx</code></li><li><code>tomcat8</code></li><li><code>guacd</code></li><li><code>pm2</code></li><li><code>mysql</code></li></ul><p><br /></p>","body_lake":"<!doctype lake><h2 id=\"858e7e78\">一、前言</h2><p><br /></p><p>本部署教程旨在搭建 F2etest 最小体验版，请预先准备 CentOS 7 虚拟机或物理机 1 台。</p><p><br /></p><h2 id=\"9cbd9b0f\">二、部署</h2><p><br /></p><blockquote><p>请预先在 CentOS 机器上安装最新版的 <code>Docker</code>，如已安装请忽略，安装教程：<a href=\"https://www.yuque.com/grasilife/docker/install-centos\" target=\"_blank\">https://www.yuque.com/grasilife/docker/install-centos</a>，</p></blockquote><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22bash%22%2C%22code%22%3A%22%23%20%E8%8E%B7%E5%8F%96%20%60f2etest-web%60%20%E9%95%9C%E5%83%8F%5Cndocker%20pull%20registry.cn-hangzhou.aliyuncs.com%2Ff2etest%2Ff2etest-web%5Cn%5Cn%23%20%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8%5Cn%23%20%E6%98%A0%E5%B0%84%E6%9C%AC%E5%9C%B0%E7%AB%AF%E5%8F%A3%EF%BC%8C%E8%BF%99%E9%87%8C%E5%B7%B2%2080%20%E4%B8%BA%E4%BE%8B%EF%BC%8C%E8%AF%B7%E7%A1%AE%E4%BF%9D%E6%AD%A4%E7%AB%AF%E5%8F%A3%E6%9C%AA%E8%A2%AB%E5%8D%A0%E7%94%A8%5Cn%23%20%E5%A6%82%E6%9E%9C%2080%20%E8%A2%AB%E5%8D%A0%E7%94%A8%EF%BC%8C%E8%AF%B7%E4%BF%AE%E6%94%B9%E4%B8%BA%E5%85%B6%E5%AE%83%E5%8F%AF%E7%94%A8%E7%AB%AF%E5%8F%A3%EF%BC%8C%E4%BE%8B%E5%A6%82%208080%20%E7%AB%AF%E5%8F%A3%EF%BC%9A-p%208080%3A80%5Cndocker%20run%20-dit%20--privileged%20-p%2080%3A80%20--name%20f2etest%20registry.cn-hangzhou.aliyuncs.com%2Ff2etest%2Ff2etest-web%5Cn%5Cn%23%20%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8%5Cndocker%20exec%20-it%20f2etest%20bash%5Cn%5Cn%23%20%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E5%B9%B6%E5%90%AF%E5%8A%A8%20Web%5Cnsource%20setup.sh%22%2C%22id%22%3A%228ac400ad%22%7D\"></card><p><br /></p><h2 id=\"7bc1a177\">三、配置</h2><p><br /></p><blockquote><p>主要配置 Windows Server IP 地址，其他相关配置已预设。</p></blockquote><p><br /></p><p>先进入容器，已进入请忽略。（<code>docker exec -it f2etest bash</code>）</p><p><br /></p><h3 id=\"5ab70705\">3.1 站点配置</h3><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22id%22%3A%225d42321a%22%2C%22mode%22%3A%22bash%22%2C%22code%22%3A%22vi%20%2Fhome%2Ff2etest-web%2Fconf%2Fsite.json%22%7D\"></card><p><br /></p><p>修改 <code>guacamoleApi</code> 字段，IP 地址改为 CentOS 机器 IP 地址，端口号改为运行容器时映射的本地端口号，<strong>80</strong> 端口可忽略。</p><p><br /></p><p>假设 CentOS IP 地址为 <strong>10.1.1.1</strong>，容器映射的端口号为 <strong>8080</strong>：</p><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22json%22%2C%22code%22%3A%22%5C%22guacamoleApi%5C%22%3A%20%5C%22http%3A%2F%2F10.1.1.1%3A8080%2Fguacamole%2Fclient.xhtml%5C%22%2C%22%2C%22id%22%3A%2240716bc0%22%7D\"></card><p><br /></p><p>了解更多：<a href=\"https://www.yuque.com/artist/f2etest/f2etest-web#1534b4e9\" target=\"_blank\">https://www.yuque.com/artist/f2etest/f2etest-web#1534b4e9</a></p><p><br /></p><h3 id=\"949f1586\">3.2 服务器配置</h3><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22id%22%3A%22d50a2a06%22%2C%22mode%22%3A%22bash%22%2C%22code%22%3A%22vi%20%2Fhome%2Ff2etest-web%2Fconf%2Fserver.json%22%7D\"></card><p><br /></p><p>修改数组中第一条记录的 <code>ip</code> 为 Windows Server 的 IP 地址。</p><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22id%22%3A%22857726b5%22%2C%22mode%22%3A%22bash%22%2C%22code%22%3A%22%23%20%E9%87%8D%E5%90%AF%20web%5Cnpm2%20restart%200%22%7D\"></card><p><br /></p><p>了解更多：<a href=\"https://www.yuque.com/artist/f2etest/f2etest-web#58c92670\" target=\"_blank\">https://www.yuque.com/artist/f2etest/f2etest-web#58c92670</a></p><p><br /></p><h3 id=\"1434e7e4\">3.3 免登配置</h3><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22id%22%3A%221447f943%22%2C%22mode%22%3A%22bash%22%2C%22code%22%3A%22vi%20%2Fetc%2Fguacamole%2Fnoauth-config.xml%22%7D\"></card><p><br /></p><p>修改 <code>&lt;param name=&quot;hostname&quot; value=&quot;192.168.1.102&quot; /&gt;</code> 中的 <code>value</code> 为 Windows Server 的 IP 地址。</p><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22id%22%3A%22657d2999%22%2C%22mode%22%3A%22bash%22%2C%22code%22%3A%22%23%20%E9%87%8D%E5%90%AF%20tomcat8%5Cnservice%20tomcat8%20restart%22%7D\"></card><p><br /></p><p>了解更多：<a href=\"https://www.yuque.com/artist/f2etest/f2etest-web#c1a9669b\" target=\"_blank\">https://www.yuque.com/artist/f2etest/f2etest-web#c1a9669b<cursor /></a></p><p><br /></p><h2 id=\"03225136\">4. 相关服务</h2><p><br /></p><ul><li><code>nginx</code></li><li><code>tomcat8</code></li><li><code>guacd</code></li><li><code>pm2</code></li><li><code>mysql</code></li></ul><p><br /></p>","public":1,"status":null,"likes_count":4,"comments_count":0,"content_updated_at":"2019-04-16T16:43:42.000Z","deleted_at":null,"created_at":"2019-04-08T10:02:36.000Z","updated_at":"2019-04-23T06:15:09.000Z","published_at":"2019-04-16T16:43:42.000Z","first_published_at":"2019-04-08T10:04:38.000Z","word_count":434,"cover":null,"description":"一、前言本部署教程旨在搭建 F2etest 最小体验版，请预先准备 CentOS 7 虚拟机或物理机 1 台。二、部署请预先在 CentOS 机器上安装最新版的 Docker，如已安装请忽略，安装教程：https://www.yuque.com/grasilife/docker/install...","custom_description":null,"_serializer":"v2.doc_detail"}