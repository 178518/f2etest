{"id":1520852,"slug":"webdriver-cloud-usage","title":"如何使用 WebDriver 云","book_id":245753,"book":{"id":245753,"type":"Book","slug":"f2etest","name":"F2etest","user_id":296279,"description":"F2etest 是一个面向前端、测试、产品等岗位的多浏览器兼容性测试整体解决方案。","creator_id":94302,"public":1,"items_count":12,"likes_count":0,"watches_count":2,"content_updated_at":"2019-04-23T07:06:18.228Z","updated_at":"2019-04-23T07:06:18.000Z","created_at":"2019-03-21T03:15:48.000Z","namespace":"artist/f2etest","user":{"id":296279,"type":"Group","login":"artist","name":"F&D艺术家-前端自动化测试","description":"探索与推广前端自动化测试","avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150693943-avatar/c80e9798-27e4-4238-8760-4bb5828a7228.png","large_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150693943-avatar/c80e9798-27e4-4238-8760-4bb5828a7228.png?x-oss-process=image/resize,m_fill,w_320,h_320","medium_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150693943-avatar/c80e9798-27e4-4238-8760-4bb5828a7228.png?x-oss-process=image/resize,m_fill,w_160,h_160","small_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/94302/1553150693943-avatar/c80e9798-27e4-4238-8760-4bb5828a7228.png?x-oss-process=image/resize,m_fill,w_80,h_80","books_count":3,"public_books_count":3,"followers_count":0,"following_count":0,"created_at":"2019-03-21T06:44:55.000Z","updated_at":"2019-04-23T05:36:48.000Z","_serializer":"v2.user"},"_serializer":"v2.book"},"user_id":182712,"creator":{"id":182712,"type":"User","login":"undead25","name":"双龙","description":null,"avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/182712/1554346835965-avatar/a9f57da4-3a12-43bc-be2c-85b7e215b7c7.png","large_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/182712/1554346835965-avatar/a9f57da4-3a12-43bc-be2c-85b7e215b7c7.png?x-oss-process=image/resize,m_fill,w_320,h_320","medium_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/182712/1554346835965-avatar/a9f57da4-3a12-43bc-be2c-85b7e215b7c7.png?x-oss-process=image/resize,m_fill,w_160,h_160","small_avatar_url":"https://cdn.nlark.com/yuque/0/2019/png/182712/1554346835965-avatar/a9f57da4-3a12-43bc-be2c-85b7e215b7c7.png?x-oss-process=image/resize,m_fill,w_80,h_80","books_count":0,"public_books_count":0,"followers_count":0,"following_count":1,"created_at":"2018-09-26T16:45:26.000Z","updated_at":"2019-04-04T03:00:41.000Z","_serializer":"v2.user"},"format":"lake","body":"","body_draft":"","body_html":"<h2 id=\"d3e49b3d\">一、WebDirver 云</h2><p><br /></p><h3 id=\"54ae9400\">1.1 使用方法</h3><p><br /></p><p>F2etest WebDriver 云使用标准的 WebDriver 协议，所有支持 WebDriver 协议的客户端，都可以直接使用。</p><p><br /></p><ul><li>F2etest WebDriver Hub 连接信息：</li></ul><p><br /></p><pre><code>host：f2etest.alibaba-inc.com\nport：4444</code></pre><p><br /></p><ul><li>初始化时提交的扩展（<span>查询地址：</span><a href=\"http://f2etest.xxx.com/webdriver\" target=\"_blank\">http://f2etest.xxx.com/webdriver</a>）：</li></ul><p><br /></p><pre><code>f2etest.userid：用户唯一标志 id\nf2etest.apiKey：useid 对应的唯一 key\nf2etest.hosts：hosts 绑定（可选）</code></pre><p><br /></p><h3 id=\"5a88867b\">1.2 节点参数须知</h3><p><br /></p><ul><li><strong>WebDriver 闲置超时</strong>：60 秒（任务会话意外中断，60 秒后会自动结束，如果希望增加调试时间，请定时发起一次任意操作，以延后回收时间）。</li></ul><p><br /></p><ul><li><strong>节点回收轮询</strong>：5 秒（节点会话结束后，5 秒内会被重新放入执行机池）。</li></ul><p><br /></p><h2 id=\"85defb8f\">二、结合 UIRecorder 使用</h2><p><br /></p><h3 id=\"cb24786d\">2.1 概述</h3><p><br /></p><p>UIRecorder 是一款 “一端录制，多端使用” 的便捷 UI 自动化测试回归工具:</p><p><br /></p><p><img alt=\"Kapture 2019-04-01 at 11.53.49.gif\" title=\"Kapture 2019-04-01 at 11.53.49.gif\" src=\"https://cdn.nlark.com/yuque/0/2019/gif/182712/1555001859084-139881ad-2aa6-43e5-957f-32edb4d4db3d.gif#align=left&amp;display=inline&amp;height=420&amp;name=Kapture%202019-04-01%20at%2011.53.49.gif&amp;originHeight=494&amp;originWidth=878&amp;size=8012768&amp;status=done&amp;width=746\" style=\"max-width: 600px; width: 746px;\" /></p><p><br /></p><h3 id=\"997fd607\">2.2 使用方法</h3><p><br /></p><p>UIRecorder 调用 F2etest WebDriver Hub 的方法我们已经做了一层封装，只需简单修改配置文件，即可调用 WebDriver Hub。</p><p>       </p><ul><li><code>config.json</code> 主要字段含义如下：</li></ul><p><br /></p><pre data-lang=\"json\"><code>{\n    &quot;webdriver&quot;: {\n        &quot;host&quot;: &quot;f2etest.xxx.com&quot;,\t\t\t\t\t\t\t\t// webdriver hub 的 host，本地则 127.0.0.1\n        &quot;port&quot;: &quot;4444&quot;,\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 默认端口号为 4444\n        &quot;f2etest.userid&quot;: &quot;xxx&quot;,\t\t\t\t\t\t\t\t\t// 用户唯一标志（鉴权使用）\n        &quot;f2etest.apiKey&quot;: &quot;xxx&quot;,\t\t\t\t\t\t\t\t\t// 用户唯一 key（鉴权使用）\n        &quot;browsers&quot;: &quot;chrome&quot;\t\t\t\t\t\t\t\t\t\t\t// 指定回归测试浏览器类型\n    },\n}</code></pre><p><br /></p><h2 id=\"968945a5\">三、JS 单元测试</h2><p><br /></p><h3 id=\"a0255241\">3.1 概述</h3><p><br /></p><p>JS 单元测试对于 JS 组件是最基础的质量覆盖手段，逻辑越复杂，使用率越高，单元测试的编写价值就越大。我们主要提供了基于 Karma 配合 F2etest 的执行机来实现JS单元测试的多浏览器持续集成解决方案。</p><p><br /></p><h3 id=\"47c32961\">3.2 使用方法</h3><p><br /></p><ol start=\"1\"><li>安装开发依赖：<code>npm i mocha karma karma-mocha-reporter karma-expect karma-coverage karma-chrome-laucher karma-webdriver-laucher --save-dev</code> 。</li></ol><p><br /></p><ol start=\"2\"><li>在 <a href=\"http://f2etest.alibaba-inc.com/jsunit\" target=\"_blank\">http://f2etest.alibaba-inc.com/jsunit</a> 下载 <code>karma.conf.js</code> 文件。</li></ol><p><br /></p><ol start=\"3\"><li>编辑 <code>package.json</code> 如下：</li></ol><p><br /></p><pre data-lang=\"json\"><code>{\n  ...\n  &quot;scripts&quot;: {\n    &quot;test&quot;: &quot;./node_modules/.bin/karma start&quot;,\n    &quot;f2etest&quot;: &quot;./node_modules/.bin/karma start --single-run --browsers f2etest-chrome,f2etest-firefox,f2etest-ie8,f2etest-ie9,f2etest-ie10,f2etest-ie11&quot;\n  }\n  ...\n}</code></pre><p><br /></p><ol start=\"4\"><li>新建测试用例 <code>test/test.spec.js</code>（编写方法及案例可参考 mocha 官方文档：<a href=\"https://mochajs.org/\" target=\"_blank\">https://mochajs.org</a>）：</li></ol><p><br /></p><pre data-lang=\"javascript\"><code>describe('测试用例', function () {\n    it('1等于1', function () {\n        expect(1).to.equal(1);\n        console.log('logtest');\n    });\n});</code></pre><p><br /></p><ol start=\"5\"><li>开发运行 <code>npm run test</code>（连接本地 Chrome 浏览器，监听文件变更并自动触发单元测试，并显示覆盖率情况）。</li></ol><p><br /></p><ol start=\"6\"><li>持续集成运行 <code>npm run f2etest</code>（在远端多个浏览器中同时执行单元测试，并获取覆盖率数据）</li></ol>","body_lake":"<!doctype lake><h2 id=\"d3e49b3d\">一、WebDirver 云</h2><p><br /></p><h3 id=\"54ae9400\">1.1 使用方法</h3><p><br /></p><p>F2etest WebDriver 云使用标准的 WebDriver 协议，所有支持 WebDriver 协议的客户端，都可以直接使用。</p><p><br /></p><ul><li>F2etest WebDriver Hub 连接信息：</li></ul><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22plain%22%2C%22code%22%3A%22host%EF%BC%9Af2etest.alibaba-inc.com%5Cnport%EF%BC%9A4444%22%2C%22id%22%3A%22Mz2hA%22%7D\"></card><p><br /></p><ul><li>初始化时提交的扩展（<span>查询地址：</span><a href=\"http://f2etest.xxx.com/webdriver\" target=\"_blank\">http://f2etest.xxx.com/webdriver</a>）：</li></ul><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22plain%22%2C%22code%22%3A%22f2etest.userid%EF%BC%9A%E7%94%A8%E6%88%B7%E5%94%AF%E4%B8%80%E6%A0%87%E5%BF%97%20id%5Cnf2etest.apiKey%EF%BC%9Auseid%20%E5%AF%B9%E5%BA%94%E7%9A%84%E5%94%AF%E4%B8%80%20key%5Cnf2etest.hosts%EF%BC%9Ahosts%20%E7%BB%91%E5%AE%9A%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89%22%2C%22id%22%3A%22fhaQB%22%7D\"></card><p><br /></p><h3 id=\"5a88867b\">1.2 节点参数须知</h3><p><br /></p><ul><li><strong>WebDriver 闲置超时</strong>：60 秒（任务会话意外中断，60 秒后会自动结束，如果希望增加调试时间，请定时发起一次任意操作，以延后回收时间）。</li></ul><p><br /></p><ul><li><strong>节点回收轮询</strong>：5 秒（节点会话结束后，5 秒内会被重新放入执行机池）。</li></ul><p><br /></p><h2 id=\"85defb8f\">二、结合 UIRecorder 使用</h2><p><br /></p><h3 id=\"cb24786d\">2.1 概述</h3><p><br /></p><p>UIRecorder 是一款 “一端录制，多端使用” 的便捷 UI 自动化测试回归工具:</p><p><br /></p><p><card type=\"inline\" name=\"image\" value=\"data:%7B%22src%22%3A%22https%3A%2F%2Fcdn.nlark.com%2Fyuque%2F0%2F2019%2Fgif%2F182712%2F1555001859084-139881ad-2aa6-43e5-957f-32edb4d4db3d.gif%22%2C%22originWidth%22%3A878%2C%22originHeight%22%3A494%2C%22name%22%3A%22Kapture%202019-04-01%20at%2011.53.49.gif%22%2C%22size%22%3A8012768%2C%22display%22%3A%22inline%22%2C%22align%22%3A%22left%22%2C%22linkTarget%22%3A%22_blank%22%2C%22status%22%3A%22done%22%2C%22width%22%3A746%2C%22height%22%3A420%7D\"></card></p><p><br /></p><h3 id=\"997fd607\">2.2 使用方法</h3><p><br /></p><p>UIRecorder 调用 F2etest WebDriver Hub 的方法我们已经做了一层封装，只需简单修改配置文件，即可调用 WebDriver Hub。</p><p>       </p><ul><li><code>config.json</code> 主要字段含义如下：</li></ul><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22json%22%2C%22code%22%3A%22%7B%5Cn%20%20%20%20%5C%22webdriver%5C%22%3A%20%7B%5Cn%20%20%20%20%20%20%20%20%5C%22host%5C%22%3A%20%5C%22f2etest.xxx.com%5C%22%2C%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%2F%2F%20webdriver%20hub%20%E7%9A%84%20host%EF%BC%8C%E6%9C%AC%E5%9C%B0%E5%88%99%20127.0.0.1%5Cn%20%20%20%20%20%20%20%20%5C%22port%5C%22%3A%20%5C%224444%5C%22%2C%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%2F%2F%20%E9%BB%98%E8%AE%A4%E7%AB%AF%E5%8F%A3%E5%8F%B7%E4%B8%BA%204444%5Cn%20%20%20%20%20%20%20%20%5C%22f2etest.userid%5C%22%3A%20%5C%22xxx%5C%22%2C%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%2F%2F%20%E7%94%A8%E6%88%B7%E5%94%AF%E4%B8%80%E6%A0%87%E5%BF%97%EF%BC%88%E9%89%B4%E6%9D%83%E4%BD%BF%E7%94%A8%EF%BC%89%5Cn%20%20%20%20%20%20%20%20%5C%22f2etest.apiKey%5C%22%3A%20%5C%22xxx%5C%22%2C%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%2F%2F%20%E7%94%A8%E6%88%B7%E5%94%AF%E4%B8%80%20key%EF%BC%88%E9%89%B4%E6%9D%83%E4%BD%BF%E7%94%A8%EF%BC%89%5Cn%20%20%20%20%20%20%20%20%5C%22browsers%5C%22%3A%20%5C%22chrome%5C%22%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%5Ct%2F%2F%20%E6%8C%87%E5%AE%9A%E5%9B%9E%E5%BD%92%E6%B5%8B%E8%AF%95%E6%B5%8F%E8%A7%88%E5%99%A8%E7%B1%BB%E5%9E%8B%5Cn%20%20%20%20%7D%2C%5Cn%7D%22%2C%22id%22%3A%22rIAI4%22%7D\"></card><p><br /></p><h2 id=\"968945a5\">三、JS 单元测试</h2><p><br /></p><h3 id=\"a0255241\">3.1 概述</h3><p><br /></p><p>JS 单元测试对于 JS 组件是最基础的质量覆盖手段，逻辑越复杂，使用率越高，单元测试的编写价值就越大。我们主要提供了基于 Karma 配合 F2etest 的执行机来实现JS单元测试的多浏览器持续集成解决方案。</p><p><br /></p><h3 id=\"47c32961\">3.2 使用方法</h3><p><br /></p><ol start=\"1\"><li>安装开发依赖：<code>npm i mocha karma karma-mocha-reporter karma-expect karma-coverage karma-chrome-laucher karma-webdriver-laucher --save-dev</code> 。</li></ol><p><br /></p><ol start=\"2\"><li>在 <a href=\"http://f2etest.alibaba-inc.com/jsunit\" target=\"_blank\">http://f2etest.alibaba-inc.com/jsunit</a> 下载 <code>karma.conf.js</code> 文件。</li></ol><p><br /></p><ol start=\"3\"><li>编辑 <code>package.json</code> 如下：<cursor /></li></ol><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22json%22%2C%22code%22%3A%22%7B%5Cn%20%20...%5Cn%20%20%5C%22scripts%5C%22%3A%20%7B%5Cn%20%20%20%20%5C%22test%5C%22%3A%20%5C%22.%2Fnode_modules%2F.bin%2Fkarma%20start%5C%22%2C%5Cn%20%20%20%20%5C%22f2etest%5C%22%3A%20%5C%22.%2Fnode_modules%2F.bin%2Fkarma%20start%20--single-run%20--browsers%20f2etest-chrome%2Cf2etest-firefox%2Cf2etest-ie8%2Cf2etest-ie9%2Cf2etest-ie10%2Cf2etest-ie11%5C%22%5Cn%20%20%7D%5Cn%20%20...%5Cn%7D%22%2C%22id%22%3A%22C9tMZ%22%7D\"></card><p><br /></p><ol start=\"4\"><li>新建测试用例 <code>test/test.spec.js</code>（编写方法及案例可参考 mocha 官方文档：<a href=\"https://mochajs.org/\" target=\"_blank\">https://mochajs.org</a>）：</li></ol><p><br /></p><card type=\"block\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22javascript%22%2C%22code%22%3A%22describe('%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B'%2C%20function%20()%20%7B%5Cn%20%20%20%20it('1%E7%AD%89%E4%BA%8E1'%2C%20function%20()%20%7B%5Cn%20%20%20%20%20%20%20%20expect(1).to.equal(1)%3B%5Cn%20%20%20%20%20%20%20%20console.log('logtest')%3B%5Cn%20%20%20%20%7D)%3B%5Cn%7D)%3B%22%2C%22id%22%3A%22iQSX7%22%7D\"></card><p><br /></p><ol start=\"5\"><li>开发运行 <code>npm run test</code>（连接本地 Chrome 浏览器，监听文件变更并自动触发单元测试，并显示覆盖率情况）。</li></ol><p><br /></p><ol start=\"6\"><li>持续集成运行 <code>npm run f2etest</code>（在远端多个浏览器中同时执行单元测试，并获取覆盖率数据）</li></ol>","public":1,"status":null,"likes_count":4,"comments_count":0,"content_updated_at":"2019-04-11T17:37:04.000Z","deleted_at":null,"created_at":"2019-04-11T16:57:21.000Z","updated_at":"2019-04-23T06:15:31.000Z","published_at":"2019-04-11T17:37:04.000Z","first_published_at":"2019-04-11T17:04:14.000Z","word_count":653,"cover":null,"description":"一、WebDirver 云1.1 使用方法F2etest WebDriver 云使用标准的 WebDriver 协议，所有支持 WebDriver 协议的客户端，都可以直接使用。F2etest WebDriver Hub 连接信息：host：f2etest.alibaba-inc.com po...","custom_description":null,"_serializer":"v2.doc_detail"}